# 04 - POO ++

## Constructeur par recopie

![Constructeur par recopie](../pdf/cours/bts2/bts2_03_constructeur_recopie.pdf)

### Exercice 0

Compl√©ter la classe `Tab` suivante permettant de g√©rer un tableau d‚Äôentiers en allocation dynamique et pr√©sentant un bug lors de son utilisation  dans le fichier exo.cpp √† la ligne 17.
    
```cpp
// Tab.h
#ifndef TAB_H
#define TAB_H
class Tab {
    private :
        int count;
        int * first;
    public :
        Tab(int);
        ~Tab();
        void insert(int, int);
        int get(int);
        void display();
};
#endif
```

```cpp
// Tab.cpp
#include "Tab.h"
#include <iostream>

Tab::Tab(int _count) {
    count = _count;
    first = new int[count]{0};
}

Tab::~Tab() {
    delete [] first;
}

void Tab::insert(int i, int value) {
    if (i >= 0 && i < count) {
        first[i] = value;
    }
}

int Tab::get(int i) {
    if (i >= 0 && i < count) {
        return first[i];
    }
    throw "Indice hors-limite !";
}

void Tab::display(){
    std::cout << "[ ";
    for (int i = 0; i < count; i++) {
        std::cout << first[i] << (i < count - 1 ? ", " : "" );
    }
    std::cout << " ]\n";
}
```

```cpp  linenums="1"
// exo0.cpp
#include "Tab.h"

int main() {
    Tab t1(10);

    t1.display();
    t1.insert(3, 45);
    t1.insert(7, -89053);
    t1.display();
    std::cout << "t1[3] : " << t1.get(3) << std::endl;

    Tab t2 = t1;
    t2.display();
    t2.insert(6, 78);
    t2.display();
    t1.display(); // üò±

    return 0;
}
```
    
??? success "Solution"
    
    ![](../images/meme/waiting-bean.gif)

### Exercice 1

Soit le programme suivant :

```cpp
#include "Truc.h"

void fonction (Truc a) {
	// Ne se passe-t-il vraiment rien ici ü§î
}

int main() {
    Truc x;
    Truc y = x;
    fonction(y);
    cout << "Bonjour !" << endl;
}
```

Cr√©er la classe `Truc` de mani√®re √† ce que le programme ci-dessus fournisse le r√©sultat suivant :

```
> ./exo1.exe
Cr√©ation d'un truc
Copie d'un truc
Copie d'un truc
Destruction d'un truc
Bonjour !
Destruction d'un truc
Destruction d'un truc
```

??? success "Solution"
    
    ![](../images/meme/waiting-bean.gif)

### Exercice 2

!!! danger "A faire sur papier !"

Que va afficher le programme suivant ?

```cpp
#include <iostream>

using namespace std;

class Point {
    private:
        int x, y;
    public:
        Point(int abs = 1, int ord = 0) {
            x = abs;
            y = ord;
            cout << "C : " << x << ", " << y << endl;
        };
        Point(Point &);
        ~Point();
};

Point::Point(Point & d) {
    cout << "R : " << d.x << ", " << d.y << endl;
    x = d.x;
    y = d.y;
}

Point::~Point() {
    cout << "D !"<< endl;
}

void fct (Point, Point *);

int main() {
    cout << "D√©but main" << endl;
    Point a;
    Point c = a;
    Point *adr = new Point (3, 3);
    fct(a, adr);
    c = Point(5, 5);
    cout << "Fin main" << endl;
}

void fct (Point d, Point * add) {
    cout << "Entr√©e fct" << endl;
    delete add;
    cout << "Sortie fct" << endl;
}
```

??? success "Solution"
    
    ![](../images/meme/waiting-bean.gif)

